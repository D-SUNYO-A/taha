<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TAHA</title>
    <link rel="stylesheet" href="./assets/css/index.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <header class="container">
      <img src="./assets/img/logo.png" alt="logo" />
      <div class="title">
        <h1>TAHA</h1>
        <h3>(<b>T</b>aha mi<b>A</b>ntoka ny <b>H</b>erin'ny <b>A</b>riary)</h3>
      </div>
      <div class="stats">
        <div class="stats-content">
          <div class="graph">
            <img src="./assets/img/side_donut.png" alt="graph" />
            <span>10%</span>
          </div>
          <h2 class="date">02 | 05 | 2024</h2>
        </div>
      </div>
    </header>
    <main class="container">
      <p class="description">
        La référence des marchés reflète le coût des emprunts au jour le jour
        appliqué par les banques de la place. Il s'agit du taux moyen pondéré
        des opérations sans risque à un jour de maturité sur le marché
        interbancaire en Ariary.
      </p>
      <div class="table-container">
        <table id="myTable">
          <thead>
            <tr>
              <th class="empty"></th>
              <th>Taux</th>
              <th>Volume de transaction (MDS d'Ariary)</th>
              <th>Nombre de participants</th>
              <th>Nombre de transactions</th>
              <th>Taux min</th>
              <th>Taux max</th>
              <th>Mode de calcul</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>02/05/2024</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td><span class="actif"></span> Normal</td>
            </tr>
            <tr>
              <td>30/04/2024</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td><span class="actif"></span> Normal</td>
            </tr>
            <tr>
              <td>29/04/2024</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td><span class="actif"></span> Normal</td>
            </tr>
            <tr>
              <td>28/04/2024</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td><span class="actif"></span> Normal</td>
            </tr>
            <tr>
              <td>27/04/2024</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td><span class="actif"></span> Normal</td>
            </tr>
            <tr>
              <td>26/04/2024</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td><span class="actif"></span> Normal</td>
            </tr>
            <tr>
              <td>25/04/2024</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td>--</td>
              <td><span class="actif"></span> Normal</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="table-recap">
        <div class="tfm">
          <div>
            <p>Taux de facilité</p>
            <p>de prêt marginal</p>
          </div>
          <span>11.00%</span>
        </div>
        <div class="tfd">
          <div>
            <p>Taux de facilité</p>
            <p>de dépôt</p>
          </div>
          <span>18.00%</span>
        </div>
      </div>

      <div class="chart-section">
        <div class="chart-container">
          <canvas id="moisChart"></canvas>
        </div>
        <div class="chart-legend">
          <button>
            <p>Taux des facilités</p>
            <p>de prêt marginal</p>
          </button>
          <button>Taux des références</button>
          <button>
            <p>Taux des facilités</p>
            <p>de dépôt</p>
          </button>
          <div class="exports">
            <a href="#" class="xls"
              ><img src="./assets/img/exel.png" alt="exel"
            /></a>
            <a href="#" class="pdf"
              ><img src="./assets/img/pdf.png" alt="pdf"
            /></a>
          </div>
        </div>
      </div>
    </main>

    <script src="./assets/js/index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Données des mois de l'année
        const periode = [];
        const tauxFPM = [];
        const tauxFDD = [];
        const tauxREF = [];

        //const labelsX = Array.from({ length: 5 }, (_, i) => (i + 8.5).toFixed(1));
        const labelsX = [8.5, 9, 9.5, 10, 10.5, 11, 11.5, 12];
        console.log(labelsX);

        const apiUrl =
          "https://www.banky-foibe.mg/admin/wp-json/bfm/taux_interbancaire_tous?limit=30";

        // Make a GET request
        fetch(apiUrl)
          .then((response) => {
            if (!response.ok) {
              throw new Error("Network response was not ok");
            }
            return response.json();
          })
          .then((data) => {
            // Configuration du graphique
            var items = data.data.data[0];
            console.log(items);

            for (let i = 0; i < items.length; i++) {
              console.log(items[i].TAUX);
              periode[i] = items[i].D_DATE;
              tauxFPM[i] = "11";
              tauxFDD[i] = "9";
              tauxREF[i] = parseFloat(items[i].TAUX);
            }

            console.log(tauxREF);
            const config = {
              type: "line",

              data: {
                labels: periode,
                datasets: [
                  {
                    label: "TAUX DES FACILITES DE PRET MARGINAL",
                    data: tauxFPM,
                    fill: false,
                    borderColor: "#2f62bd",
                    borderWidth: 2,
                    pointRadius: 1,
                  },
                  {
                    label: "TAUX DES FACILITES DES DEPOTS",
                    data: tauxFDD,
                    fill: false,
                    borderColor: "#ec7b2e",
                    borderWidth: 2,
                    pointRadius: 1,
                  },
                  {
                    label: "TAUX DES REFERENCES",
                    data: tauxREF,
                    fill: false,
                    borderColor: "#a4a4a4",
                    borderWidth: 2,
                    pointRadius: 1,
                  },
                ],
              },
              options: {
                plugins: {
                  legend: {
                    display: false,
                    position: "top",
                  },
                },
                elements: {
                  line: {
                    tension: 0, // Pour rendre les lignes droites
                  },
                },
                layout: {
                  padding: {
                    left: 50,
                    right: 50,
                    top: 10,
                    bottom: 10,
                  },
                },
                scales: {
                  x: {
                    display: true, // Pour cacher les lignes de grille de l'axe x
                    grid: {
                      display: false,
                    },
                  },
                  y: {
                    display: true, // Pour cacher les lignes de grille de l'axe y
                    grid: {
                      display: false,
                    },
                  },
                },
              },
            };

            // Création du graphique
            const ctx = document.getElementById("moisChart").getContext("2d");
            new Chart(ctx, config);
          });
      });
    </script>
  </body>
</html>
